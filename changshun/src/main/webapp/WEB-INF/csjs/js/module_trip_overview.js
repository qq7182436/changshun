define("tour_amd/module_trip_overview",["jquery","layer"],function($){var TripOverview=function(cfg){this.cfg=cfg;this.init();this.bindEvents();}
TripOverview.prototype={init:function(){$.extend(this,this.cfg);this.spotList=this.elt.find(".col3 a");},bindEvents:function(){this.spotList.on("click",$.proxy(this.onSpotItemClick,this));},onSpotItemClick:function(e){var spotid=$(e.target).attr("data-spotid");if(spotid){var promise=this.querySpotInfo(spotid);promise.then(function(data){if(data){var i=$.layer({type:1,shadeClose:true,fix:false,title:data.spotDetailHTMLTitle,border:[6,0.3,'#000'],area:['804px','420px'],page:{html:data.spotDetailHTMLBody},success:function(page){$(page).addClass("layer_spot");$(page).find(".gy-gallery").gyGallery({"width":490,"height":275});}});}});}},querySpotInfo:function(id){var promise=$.ajax({url:"/yii.php?r=detail/tourAjax/getSpotDetail",dataType:"jsonp",jsonp:"callback",data:{spotid:id}});return promise;}}
return TripOverview;});